open GoduBsAva.Sync;
open Cell;
open Console;

let (_0, _1, _2, _3, _4, _5, _6, _7, _8, _9) = (
  Empty,
  Value(One),
  Value(Two),
  Value(Three),
  Value(Four),
  Value(Five),
  Value(Six),
  Value(Seven),
  Value(Eight),
  Value(Nine),
);

test("printCell", t =>
  [_0, _1, _2, _3, _4, _5, _6, _7, _8, _9]
  |> List.map(cell => cell |> printCell)
  |> t.deepEqual([".", "1", "2", "3", "4", "5", "6", "7", "8", "9"])
);

test("printRow", t => {
  (_0, _0, _0, _0, _0, _0, _0, _0, _0)
  |> printRow
  |> t.is("|. . .|. . .|. . .|");
  (_1, _2, _3, _4, _5, _6, _7, _8, _9)
  |> printRow
  |> t.is("|1 2 3|4 5 6|7 8 9|");
});

test("printGrid", t =>
  (
    (_1, _2, _3, _4, _5, _6, _7, _8, _9),
    (_1, _2, _3, _4, _5, _6, _7, _8, _9),
    (_1, _2, _3, _4, _5, _6, _7, _8, _9),
    (_0, _0, _0, _0, _0, _0, _0, _0, _0),
    (_0, _0, _0, _0, _0, _0, _0, _0, _0),
    (_0, _0, _0, _0, _0, _0, _0, _0, _0),
    (_1, _2, _3, _4, _5, _6, _7, _8, _9),
    (_1, _2, _3, _4, _5, _6, _7, _8, _9),
    (_1, _2, _3, _4, _5, _6, _7, _8, _9),
  )
  |> printGrid
  |> t.is("   1 2 3 4 5 6 7 8 9
  +-----+-----+-----+
1 |1 2 3|4 5 6|7 8 9|
2 |1 2 3|4 5 6|7 8 9|
3 |1 2 3|4 5 6|7 8 9|
  +-----+-----+-----+
4 |. . .|. . .|. . .|
5 |. . .|. . .|. . .|
6 |. . .|. . .|. . .|
  +-----+-----+-----+
7 |1 2 3|4 5 6|7 8 9|
8 |1 2 3|4 5 6|7 8 9|
9 |1 2 3|4 5 6|7 8 9|
  +-----+-----+-----+")
);
